<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> The generalized eigenvalue problem | Kamal Maher </title> <meta name="author" content="Kamal Maher"> <meta name="description" content="Interpreting generalized eigenvalue problems as comparative PCA"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%AB%A7&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://kmaherx.github.io/blog/2025/geneig/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Kamal</span> Maher </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog </a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">The generalized eigenvalue problem</h1> <p class="post-meta"> Created on June 11, 2025 </p> <p class="post-tags"> <a href="/blog/2025"> <i class="fa-solid fa-calendar fa-sm"></i> 2025 </a>   ·   <a href="/blog/category/math"> <i class="fa-solid fa-tag fa-sm"></i> math</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <h2 id="introduction">Introduction</h2> <p>When I was just getting started in computational research, I often found myself exploring the <a href="https://docs.scipy.org/doc/scipy/reference/linalg.html" rel="external nofollow noopener" target="_blank"><code class="language-plaintext highlighter-rouge">scipy.linalg</code> documentation</a> just to get a sense of what tools were available. A critical tool I ended up using frequently was the function for symmetric matrix eigendecomposition, <code class="language-plaintext highlighter-rouge">scipy.linalg.eigh</code>, as it solves the eigenvalue problem underlying <a href="/blog/2025/pca">principal component analysis (PCA)</a> and much of <a href="/blog/2025/graph-fourier">graph signal processing</a>. Briefly, if $\mathbf{A}$ represented a covariance matrix, one could calculate the top PC by solving</p> \[\mathbf{A} \mathbf{v} = \lambda \mathbf{v}.\] <p>However, as I became more familiar with this function, I noticed that it optionally accepted a <em>second</em> matrix as input. Given the two matrices, $\mathbf{A}$ and $\mathbf{B}$, it would apparently solve the <a href="https://arxiv.org/abs/1903.11240" rel="external nofollow noopener" target="_blank"><em>generalized</em> eigenvalue problem</a>:</p> \[\begin{equation} \label{eq:geneigprob} \mathbf{A} \mathbf{v} = \lambda \mathbf{B} \mathbf{v}. \end{equation}\] <p>For a long time, I didn’t have a great intuition for what this equation represented. After watching <a href="https://en.wikipedia.org/wiki/Arrival_(film)" rel="external nofollow noopener" target="_blank">Arrival</a> on a flight one time, I was inspired to make great scientific strides, but I ended up with the following interpretation of the generalized eigenvalue problem instead.</p> <hr> <h2 id="brief-recap-of-pca">Brief recap of PCA</h2> <p>As shown in a <a href="/blog/2025/pca">previous post</a>, PCA can be seen as reconstructing the graph of similarities between data points with the least amount of information. We’ll slightly change our approach to focus on the features here, but the results are the same whether you consider observations or features. The original information spanning $n$ observations of $g$ features is given by the data matrix</p> \[\mathbf{X} \in \mathbb{R}^{n \times g},\] <p>which we will think of as $g$ genes measured across $n$ cells from a patient with a particular disease.</p> <p>We are interested in a “reduced” representation given by</p> \[\mathbf{v} \in \mathbb{R}^{g},\] <p>which can be thought of as a data matrix with only a single column – i.e. a “<a href="https://www.pnas.org/doi/full/10.1073/pnas.0308531101" rel="external nofollow noopener" target="_blank">metagene</a>” or “<a href="https://elifesciences.org/articles/43803" rel="external nofollow noopener" target="_blank">gene program</a>” – and which we might assume is associated with the patient’s disease. Each representation yields relationships between features that we can think of as graphs (i.e. covariance matrices), which are given by</p> \[\mathbf{X} \mathbf{X}^{\top}, \mathbf{v} \mathbf{v}^{\top} \in \mathbb{R}^{g \times g}.\] <p>We can then quantify how well these graphs match by comparing each edge weight via the summation</p> \[\lambda = \sum_{ij} (\mathbf{X} \mathbf{X}^{\top})_{ij} (\mathbf{v} \mathbf{v}^{\top})_{ij},\] <p>which boils down to the quadratic form</p> \[\lambda = \mathbf{v}^{\top} \mathbf{A} \mathbf{v},\] <p>where $\mathbf{A} = \mathbf{X} \mathbf{X}^{\top}$ is the adjacency matrix associated with the true data graph.</p> <p>Normalizing by the magnitude of $\mathbf{v}$, we get</p> \[\lambda = \frac{\mathbf{v}^{\top} \mathbf{A} \mathbf{v}}{\mathbf{v}^{\top} \mathbf{v}}.\] <p>which simplifies down to an eigenvalue problem via</p> \[\Rightarrow \lambda \mathbf{v}^{\top} \mathbf{v} = \mathbf{v}^{\top} \mathbf{A} \mathbf{v} \nonumber \\\] \[\begin{equation} \label{eq:eigprob} \Rightarrow \lambda \mathbf{v} = \mathbf{A} \mathbf{v}. \end{equation}\] <p>Thus, by finding the eigenvector $\mathbf{v}$ with the largest eigenvalue $\lambda$, we can find a “condensed representation” of the gene expression patterns in $\mathbf{X}$. With this intuition in mind, we can now “generalize” PCA to find relationships present in one graph, $\mathbf{A}$, but not another, $\mathbf{B}$.</p> <hr> <h2 id="generalization">Generalization</h2> <p>In the single-cell analysis context mentioned above, the top gene programs (i.e. PCs) we identify would likely just describe critical functions present in <em>both healthy and disease</em> patients. In order to deal with this, we would probably need to somehow specify that <strong>we want to find patterns that are present uniquely in disease data and <em>not healthy data</em>.</strong></p> <p>Consider we collected a second sample from a <em>healthy</em> patient that yielded the data matrix,</p> \[\mathbf{Y} \in \mathbb{R}^{m \times g}.\] <p>While the number of cells measured in this assay might differ from that of the first (i.e. $n\neq m$), we can still compare the two in terms of their features (hence why we are working with <em>feature</em> covariances in this post). The graph of feature relationships for this healthy sample is given by</p> \[\mathbf{B} = \mathbf{Y} \mathbf{Y}^{\top} \in \mathbb{R}^{g \times g}.\] <p>Our goal is now to somehow remove the information in $\mathbf{B}$ from that of $\mathbf{A}$. If we were doing this with <em>scalar</em> values associated with each dataset $a,b \in \mathbb{R}$, we could simply divide out $b$:</p> \[\frac{a}{b}.\] <p>But we are trying to do this with <em>matrices</em> $\mathbf{A}, \mathbf{B} \in \mathbb{R}^{g \times g}$, which we can’t divide in the same way. Nevertheless, we can think of division instead as <strong>multiplication by an inverse</strong>:</p> \[b^{-1} a.\] <p>This actually does generalize to matrices, so long as they are invertible. Because $\mathbf{A}$ and $\mathbf{B}$ are positive definite, they are invertible and we can calculate the inverse</p> \[\mathbf{B}^{-1} \mathbf{A},\] <p>which represents the information present in $\mathbf{A}$ but not $\mathbf{B}$. Because this product is just another matrix itself, we should just be able to <strong>plug it into an eigenvalue problem to find the dominant patterns, which should now be disease-specific:</strong></p> \[\mathbf{B}^{-1} \mathbf{A} \mathbf{v} = \lambda \mathbf{v}.\] <p>And that’s it, there’s our final equation and intuition. All we need to do is <strong>multiply each side by $\mathbf{B}$ and we arrive at our original eq. \eqref{eq:geneigprob}.</strong></p> <p>One last thing I’d like to do is provide <strong>intuition in the form of Rayleigh quotients.</strong> Just as we flipped between eigenvalue problem and Rayleigh quotient in eq. \eqref{eq:eigprob}, so we can do with the generalized problem:</p> \[\mathbf{A} \mathbf{v} = \lambda \mathbf{B} \mathbf{v}\] \[\Rightarrow \mathbf{v}^{\top} \mathbf{A} \mathbf{v} = \lambda \mathbf{v}^{\top} \mathbf{B} \mathbf{v}\nonumber \\\] \[\Rightarrow \lambda = \frac{\mathbf{v}^{\top} \mathbf{A} \mathbf{v}}{\mathbf{v}^{\top} \mathbf{B} \mathbf{v}}. \nonumber\] <p>Here, we can see more clearly that the prominence of our component (i.e. the eigenvalue of $\mathbf{v}$, $\lambda$) is governed by how much it can emphasize the relationships in graph $\mathbf{A}$ <strong>while <em>deemphasizing</em> the relationships in graph $\mathbf{B}$.</strong></p> <hr> <h2 id="conclusion">Conclusion</h2> <p>Altogether, we have shown <strong>two different ways in which generalized eigenvalue problems can be interpreted as a sort of comparative PCA.</strong> Note that this interpretation is also made clear in <a href="https://en.wikipedia.org/wiki/Linear_discriminant_analysis#Multiclass_LDA" rel="external nofollow noopener" target="_blank">linear discriminant analysis</a>. It can also be applied to canonical correlations analysis, as seen <a href="https://cca-zoo.readthedocs.io/en/dev/documentation/maths.html" rel="external nofollow noopener" target="_blank">here</a> and <a href="https://gregorygundersen.com/blog/2018/07/17/cca/" rel="external nofollow noopener" target="_blank">here</a>. Honestly, I’m surprised it isn’t totally abused in single-cell analysis to find disease-specific features, but maybe that’s partially because <a href="https://www.nature.com/articles/s41592-023-01814-1" rel="external nofollow noopener" target="_blank">scRNA-seq data violates key distributional assumptions</a>.</p> <p>Hope this was insightful.</p> </div> </article> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 Kamal Maher. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>